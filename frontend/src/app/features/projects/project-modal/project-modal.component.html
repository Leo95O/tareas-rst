<p-dialog [(visible)]="visible" [modal]="true" [draggable]="false" [resizable]="false" [closable]="true"
  [header]="modalTitle" [style]="{ width: '600px', maxHeight: '90vh' }"
  [contentStyle]="{ 'overflow-y': 'auto', 'max-height': 'calc(90vh - 150px)' }" (onHide)="closeModal()">
  <form [formGroup]="projectForm" (ngSubmit)="onSubmit()" class="space-y-4">
    <!-- Nombre del Proyecto -->
    <div class="flex flex-col gap-2">
      <label for="nombre" class="font-semibold text-gray-700">
        Nombre del Proyecto <span class="text-red-500">*</span>
      </label>
      <input pInputText id="nombre" formControlName="nombre" placeholder="Ej: Sistema de Inventario" class="w-full"
        [class.ng-invalid]="
          projectForm.get('nombre')?.invalid && projectForm.get('nombre')?.touched
        " />
      @if (getErrorMessage('nombre')) {
      <small class="text-red-600">{{ getErrorMessage('nombre') }}</small>
      }
    </div>

    <!-- Sucursal -->
    <div class="flex flex-col gap-2">
      <label for="sucursal_id" class="font-semibold text-gray-700">
        Sucursal <span class="text-red-500">*</span>
      </label>
      <p-select id="sucursal_id" formControlName="sucursal_id" [options]="sucursales()" optionLabel="nombre"
        optionValue="id" placeholder="Selecciona una sucursal" styleClass="w-full" [class.ng-invalid]="
          projectForm.get('sucursal_id')?.invalid && projectForm.get('sucursal_id')?.touched
        "></p-select>
      @if (getErrorMessage('sucursal_id')) {
      <small class="text-red-600">{{ getErrorMessage('sucursal_id') }}</small>
      }
    </div>

    <!-- Descripción -->
    <div class="flex flex-col gap-2">
      <label for="descripcion" class="font-semibold text-gray-700"> Descripción </label>
      <textarea pInputTextarea id="descripcion" formControlName="descripcion" placeholder="Describe el proyecto..."
        rows="4" class="w-full" [class.ng-invalid]="
          projectForm.get('descripcion')?.invalid && projectForm.get('descripcion')?.touched
        "></textarea>
      @if (getErrorMessage('descripcion')) {
      <small class="text-red-600">{{ getErrorMessage('descripcion') }}</small>
      }
      <small class="text-gray-500">Máximo 500 caracteres</small>
    </div>

    <!-- Fechas: Inicio y Fin -->
    <div class="grid grid-cols-2 gap-4">
      <div class="flex flex-col gap-2">
        <label for="fecha_inicio" class="font-semibold text-gray-700">Fecha de Inicio</label>
        <p-datepicker id="fecha_inicio" formControlName="fecha_inicio" dateFormat="yy-mm-dd" [showIcon]="true"
          styleClass="w-full" placeholder="Selecciona fecha"></p-datepicker>
      </div>
      <div class="flex flex-col gap-2">
        <label for="fecha_fin" class="font-semibold text-gray-700">Fecha de Fin</label>
        <p-datepicker id="fecha_fin" formControlName="fecha_fin" dateFormat="yy-mm-dd" [showIcon]="true"
          styleClass="w-full" placeholder="Selecciona fecha"></p-datepicker>
      </div>
    </div>
  </form>

  <ng-template pTemplate="footer">
    <div class="flex justify-end gap-3">
      <button pButton label="Cancelar" class="p-button-text" (click)="closeModal()"></button>
      <button pButton [label]="isEditMode ? 'Actualizar' : 'Crear'" class="p-button-primary" (click)="onSubmit()"
        [disabled]="projectForm.invalid" [loading]="isLoading()"></button>
    </div>
  </ng-template>
</p-dialog>